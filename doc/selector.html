<!DOCTYPE html><html lang="en"><head><title>selector</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="selector"><meta name="groc-project-path" content="src/je/selector.js"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/je/selector.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="selector">Selector</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper">import { global, makeIterable } from <span class="hljs-string">'./util'</span>;

<span class="hljs-keyword">var</span> slice = [].slice,
    isPrototypeSet = <span class="hljs-literal">false</span>,
    reFragment = <span class="hljs-regexp">/^\s*&lt;(\w+|!)[^&gt;]*&gt;/</span>,
    reSingleTag = <span class="hljs-regexp">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;|)$/</span>,
    reSimpleSelector = <span class="hljs-regexp">/^[\.#]?[\w-]*$/</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><h2 id="">$</h2>
<p>Versatile wrapper for <code>querySelectorAll</code>.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>selector can be a String, a Node, or a NodeList.</strong><br/>(Query selector. Providing a selector string gives the default behavior. Providing a Node or NodeList will return a NodeList or $Object containing the same element(s). Providing a string that looks like HTML (i.e. starts with a <code>&lt;tag&gt;</code>) results in an attempt to create a DOM Fragment from it.)</p>
</li>
<li><p><strong>context can be a String, a Node, or a NodeList and has a default value of <code>document</code>.</strong><br/>(The context for the selector to query elements.)</p>
</li>
</ul>
<p><strong>Returns a NodeList or a $Object</strong></p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$</span><span class="hljs-params">(selector, context)</span> {</span>

    <span class="hljs-keyword">var</span> collection;

    <span class="hljs-keyword">if</span> (!selector) {

        collection = document.querySelectorAll(<span class="hljs-literal">null</span>);

    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> selector !== <span class="hljs-string">'string'</span>) {

        collection = makeIterable(selector);

    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (reFragment.test(selector)) {

        collection = createFragment(selector);

    } <span class="hljs-keyword">else</span> {

        context = context ? (<span class="hljs-keyword">typeof</span> context === <span class="hljs-string">'string'</span> ? document.querySelector(context) : context.length ? context[<span class="hljs-number">0</span>] : context) : document;

        collection = querySelector(selector, context);

    }

    <span class="hljs-keyword">return</span> $.isNative ? collection : wrap(collection);

}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="find">Find</h2>
<p>Chaining for the <code>$</code> wrapper (aliasing <code>find</code> for <code>$</code>).</p>
<pre><code>$(&#39;.selector&#39;).find(&#39;.deep&#39;).$(&#39;.deepest&#39;);</code></pre></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span><span class="hljs-params">(selector)</span> {</span>
    <span class="hljs-keyword">return</span> $(selector, <span class="hljs-keyword">this</span>);
}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><h2 id="matches">Matches</h2>
<p>Returns true if the element would be selected by the specified selector string; otherwise, returns false.</p>
<pre><code>$.matches(element, &#39;.match&#39;);</code></pre>
<p>Parameters:</p>
<ul>
<li><p><strong>element must be a Node.</strong><br/>(Element to test)</p>
</li>
<li><p><strong>selector must be a String.</strong><br/>(Selector to match against element)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> matches = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">typeof</span> Element !== <span class="hljs-string">'undefined'</span> ? Element.prototype : global,
        _matches = context.matches || context.matchesSelector || context.mozMatchesSelector || context.webkitMatchesSelector || context.msMatchesSelector || context.oMatchesSelector;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(element, selector)</span> {</span>
        <span class="hljs-keyword">return</span> _matches.call(element, selector);
    }
})();</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private method querySelector</span></p>
<p>Use the faster <code>getElementById</code> or <code>getElementsByClassName</code> over <code>querySelectorAll</code> if possible.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>selector must be a String.</strong><br/>(Query selector.)</p>
</li>
<li><p><strong>context must be a Node.</strong><br/>(The context for the selector to query elements.)</p>
</li>
</ul>
<p><strong>Returns a NodeList or a Node</strong></p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">querySelector</span><span class="hljs-params">(selector, context)</span> {</span>

    <span class="hljs-keyword">var</span> isSimpleSelector = reSimpleSelector.test(selector);

    <span class="hljs-keyword">if</span> (isSimpleSelector &amp;&amp; !$.isNative) {
        <span class="hljs-keyword">if</span> (selector[<span class="hljs-number">0</span>] === <span class="hljs-string">'#'</span>) {
            <span class="hljs-keyword">return</span> [(context.getElementById ? context : document).getElementById(selector.slice(<span class="hljs-number">1</span>))];
        }
        <span class="hljs-keyword">if</span> (selector[<span class="hljs-number">0</span>] === <span class="hljs-string">'.'</span>) {
            <span class="hljs-keyword">return</span> context.getElementsByClassName(selector.slice(<span class="hljs-number">1</span>));
        }
        <span class="hljs-keyword">return</span> context.getElementsByTagName(selector);
    }

    <span class="hljs-keyword">return</span> context.querySelectorAll(selector);

}</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private method createFragment</span></p>
<p>Create DOM fragment from an HTML string</p>
<p>Parameters:</p>
<ul>
<li><strong>html must be a String.</strong><br/>(String representing HTML.)</li>
</ul>
<p><strong>Returns a NodeList</strong></p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFragment</span><span class="hljs-params">(html)</span> {</span>

    <span class="hljs-keyword">if</span> (reSingleTag.test(html)) {
        <span class="hljs-keyword">return</span> [document.createElement(<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>)];
    }

    <span class="hljs-keyword">var</span> elements = [],
        container = document.createElement(<span class="hljs-string">'div'</span>),
        children = container.childNodes;

    container.innerHTML = html;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = children.length; i &lt; l; i++) {
        elements.push(children[i]);
    }

    <span class="hljs-keyword">return</span> elements;
}</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private method wrap</span></p>
<p>Calling <code>$(selector)</code> returns a wrapped array-like object of elements <a href="mode.html">by default</a>.</p>
<p>Parameters:</p>
<ul>
<li><strong>collection can be a NodeList or an Array.</strong><br/>(Element(s) to wrap as a <code>$Object</code>.)</li>
</ul>
<p><strong>Returns a $Object</strong><br/>(Array with augmented API.)</p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrap</span><span class="hljs-params">(collection)</span> {</span>

    <span class="hljs-keyword">if</span> (!isPrototypeSet) {
        Wrapper.prototype = $._api;
        Wrapper.prototype.constructor = Wrapper;
        isPrototypeSet = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Wrapper(collection);

}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Constructor for the Object.prototype strategy</p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Wrapper</span><span class="hljs-params">(collection)</span> {</span>
    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, length = collection.length;
    <span class="hljs-keyword">for</span> (; i &lt; length;) {
        <span class="hljs-keyword">this</span>[i] = collection[i++];
    }
    <span class="hljs-keyword">this</span>.length = length;
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Export interface</p></div></div><div class="code"><div class="wrapper">export { $, find, matches };</div></div></div></div></body></html>